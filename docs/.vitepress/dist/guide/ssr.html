<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Server-Side Rendering | Vite</title>
    <meta name="description" content="Next Generation Frontend Tooling">
    <link rel="stylesheet" href="/assets/style.a432069d.css">
    <link rel="modulepreload" href="/assets/chunks/VPAlgoliaSearchBox.a6f39dae.js">
    <link rel="modulepreload" href="/assets/chunks/ui-custom.b2b94b7c.js">
    <link rel="modulepreload" href="/assets/app.1478ba28.js">
    <link rel="modulepreload" href="/assets/guide_ssr.md.7b8f8c80.lean.js">
    
    <link rel="icon" type="image/svg+xml" href="/logo.svg">
  <meta property="og:type" content="website">
  <meta property="og:title" content="Vite">
  <meta property="og:image" content="https://main.vitejs.dev/og-image.png">
  <meta property="og:url" content="https://main.vitejs.dev">
  <meta property="twitter:description" content="Next Generation Frontend Tooling">
  <meta property="twitter:title" content="Vite">
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:image" content="https://main.vitejs.dev/og-image.png">
  <meta property="twitter:url" content="https://main.vitejs.dev">
  <script>(()=>{const e=localStorage.getItem("vitepress-theme-appearance"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-668b17a8><!--[--><!--]--><!--[--><span tabindex="-1" data-v-ea291a5a></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-ea291a5a> Skip to content </a><!--]--><!----><header class="VPNav" data-v-668b17a8 data-v-220b1062><div class="VPNavBar has-sidebar" data-v-220b1062 data-v-1266da0c><div class="container" data-v-1266da0c><div class="VPNavBarTitle has-sidebar" data-v-1266da0c data-v-08002b3c><a class="title" href="/" data-v-08002b3c><!--[--><img class="VPImage logo" src="/logo.svg" data-v-7519b325><!--]--><!--[-->Vite<!--]--></a></div><div class="content" data-v-1266da0c><div class="VPNavBarSearch search" data-v-1266da0c><div id="docsearch"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key">Meta</kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-1266da0c data-v-3c12c234><span id="main-nav-aria-label" class="visually-hidden" data-v-3c12c234>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/guide/" data-v-3c12c234 data-v-0e0c91ef data-v-50be448c><!--[-->Guide<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/config/" data-v-3c12c234 data-v-0e0c91ef data-v-50be448c><!--[-->Config<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/plugins/" data-v-3c12c234 data-v-0e0c91ef data-v-50be448c><!--[-->Plugins<!--]--><!----></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-3c12c234 data-v-b0c99fce><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-b0c99fce><span class="text" data-v-b0c99fce><!----> Links <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-b0c99fce><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-b0c99fce><div class="VPMenu" data-v-b0c99fce data-v-93b66c1c><div class="items" data-v-93b66c1c><!--[--><!--[--><div class="VPMenuLink" data-v-93b66c1c data-v-41fc7bc6><a class="VPLink link" href="https://twitter.com/vite_js" target="_blank" rel="noopener noreferrer" data-v-41fc7bc6 data-v-50be448c><!--[-->Twitter<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-50be448c><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-93b66c1c data-v-41fc7bc6><a class="VPLink link" href="https://chat.vitejs.dev" target="_blank" rel="noopener noreferrer" data-v-41fc7bc6 data-v-50be448c><!--[-->Discord Chat<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-50be448c><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-93b66c1c data-v-41fc7bc6><a class="VPLink link" href="https://github.com/vitejs/awesome-vite" target="_blank" rel="noopener noreferrer" data-v-41fc7bc6 data-v-50be448c><!--[-->Awesome Vite<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-50be448c><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-93b66c1c data-v-41fc7bc6><a class="VPLink link" href="https://dev.to/t/vite" target="_blank" rel="noopener noreferrer" data-v-41fc7bc6 data-v-50be448c><!--[-->DEV Community<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-50be448c><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-93b66c1c data-v-41fc7bc6><a class="VPLink link" href="https://vite-rollup-plugins.patak.dev/" target="_blank" rel="noopener noreferrer" data-v-41fc7bc6 data-v-50be448c><!--[-->Rollup Plugins Compat<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-50be448c><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-93b66c1c data-v-41fc7bc6><a class="VPLink link" href="https://github.com/vitejs/vite/blob/main/packages/vite/CHANGELOG.md" target="_blank" rel="noopener noreferrer" data-v-41fc7bc6 data-v-50be448c><!--[-->Changelog<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-50be448c><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-3c12c234 data-v-b0c99fce><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-b0c99fce><span class="text" data-v-b0c99fce><!----> v3 (next) <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-b0c99fce><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-b0c99fce><div class="VPMenu" data-v-b0c99fce data-v-93b66c1c><div class="items" data-v-93b66c1c><!--[--><!--[--><div class="VPMenuLink" data-v-93b66c1c data-v-41fc7bc6><a class="VPLink link" href="https://v2.vitejs.dev" target="_blank" rel="noopener noreferrer" data-v-41fc7bc6 data-v-50be448c><!--[-->v2.x (stable)<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-50be448c><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-1266da0c data-v-a40abd0a data-v-b0c99fce><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-b0c99fce><span class="text" data-v-b0c99fce><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="option-icon" data-v-b0c99fce><path d="M0 0h24v24H0z" fill="none"></path><path d=" M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z " class="css-c4d79v"></path></svg>  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-b0c99fce><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-b0c99fce><div class="VPMenu" data-v-b0c99fce data-v-93b66c1c><!----><!--[--><!--[--><div class="items" data-v-a40abd0a><p class="title" data-v-a40abd0a>English</p><!--[--><div class="VPMenuLink" data-v-a40abd0a data-v-41fc7bc6><a class="VPLink link" href="https://cn.vitejs.dev" target="_blank" rel="noopener noreferrer" data-v-41fc7bc6 data-v-50be448c><!--[-->简体中文<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-50be448c><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><div class="VPMenuLink" data-v-a40abd0a data-v-41fc7bc6><a class="VPLink link" href="https://ja.vitejs.dev" target="_blank" rel="noopener noreferrer" data-v-41fc7bc6 data-v-50be448c><!--[-->日本語<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-50be448c><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><div class="VPMenuLink" data-v-a40abd0a data-v-41fc7bc6><a class="VPLink link" href="https://es.vitejs.dev" target="_blank" rel="noopener noreferrer" data-v-41fc7bc6 data-v-50be448c><!--[-->Español<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-50be448c><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-1266da0c data-v-7627cda4><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-7627cda4 data-v-2db9fe9e data-v-8418208e><span class="check" data-v-8418208e><span class="icon" data-v-8418208e><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-2db9fe9e><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-2db9fe9e><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-1266da0c data-v-65d6b2d4 data-v-773e94b4><!--[--><a class="VPSocialLink" href="https://twitter.com/vite_js" title="twitter" target="_blank" rel="noopener noreferrer" data-v-773e94b4 data-v-177a76b9><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-177a76b9><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg><span class="visually-hidden" data-v-177a76b9>twitter</span></a><a class="VPSocialLink" href="https://chat.vitejs.dev" title="discord" target="_blank" rel="noopener noreferrer" data-v-773e94b4 data-v-177a76b9><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-177a76b9><path d="M20.222 0c1.406 0 2.54 1.137 2.607 2.475V24l-2.677-2.273-1.47-1.338-1.604-1.398.67 2.205H3.71c-1.402 0-2.54-1.065-2.54-2.476V2.48C1.17 1.142 2.31.003 3.715.003h16.5L20.222 0zm-6.118 5.683h-.03l-.202.2c2.073.6 3.076 1.537 3.076 1.537-1.336-.668-2.54-1.002-3.744-1.137-.87-.135-1.74-.064-2.475 0h-.2c-.47 0-1.47.2-2.81.735-.467.203-.735.336-.735.336s1.002-1.002 3.21-1.537l-.135-.135s-1.672-.064-3.477 1.27c0 0-1.805 3.144-1.805 7.02 0 0 1 1.74 3.743 1.806 0 0 .4-.533.805-1.002-1.54-.468-2.14-1.404-2.14-1.404s.134.066.335.2h.06c.03 0 .044.015.06.03v.006c.016.016.03.03.06.03.33.136.66.27.93.4.466.202 1.065.403 1.8.536.93.135 1.996.2 3.21 0 .6-.135 1.2-.267 1.8-.535.39-.2.87-.4 1.397-.737 0 0-.6.936-2.205 1.404.33.466.795 1 .795 1 2.744-.06 3.81-1.8 3.87-1.726 0-3.87-1.815-7.02-1.815-7.02-1.635-1.214-3.165-1.26-3.435-1.26l.056-.02zm.168 4.413c.703 0 1.27.6 1.27 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334.002-.74.573-1.338 1.27-1.338zm-4.543 0c.7 0 1.266.6 1.266 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334 0-.74.57-1.338 1.27-1.338z"></path></svg><span class="visually-hidden" data-v-177a76b9>discord</span></a><a class="VPSocialLink" href="https://github.com/vitejs/vite" title="github" target="_blank" rel="noopener noreferrer" data-v-773e94b4 data-v-177a76b9><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-177a76b9><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg><span class="visually-hidden" data-v-177a76b9>github</span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-1266da0c data-v-a0d78afa data-v-b0c99fce><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-b0c99fce><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-b0c99fce><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-b0c99fce><div class="VPMenu" data-v-b0c99fce data-v-93b66c1c><!----><!--[--><!--[--><div class="group" data-v-a0d78afa><p class="trans-title" data-v-a0d78afa>English</p><!--[--><div class="VPMenuLink" data-v-a0d78afa data-v-41fc7bc6><a class="VPLink link" href="https://cn.vitejs.dev" target="_blank" rel="noopener noreferrer" data-v-41fc7bc6 data-v-50be448c><!--[-->简体中文<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-50be448c><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><div class="VPMenuLink" data-v-a0d78afa data-v-41fc7bc6><a class="VPLink link" href="https://ja.vitejs.dev" target="_blank" rel="noopener noreferrer" data-v-41fc7bc6 data-v-50be448c><!--[-->日本語<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-50be448c><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><div class="VPMenuLink" data-v-a0d78afa data-v-41fc7bc6><a class="VPLink link" href="https://es.vitejs.dev" target="_blank" rel="noopener noreferrer" data-v-41fc7bc6 data-v-50be448c><!--[-->Español<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-50be448c><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--></div><div class="group" data-v-a0d78afa><div class="item appearance" data-v-a0d78afa><p class="label" data-v-a0d78afa>Appearance</p><div class="appearance-action" data-v-a0d78afa><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-a0d78afa data-v-2db9fe9e data-v-8418208e><span class="check" data-v-8418208e><span class="icon" data-v-8418208e><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-2db9fe9e><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-2db9fe9e><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-a0d78afa><div class="item social-links" data-v-a0d78afa><div class="VPSocialLinks social-links-list" data-v-a0d78afa data-v-773e94b4><!--[--><a class="VPSocialLink" href="https://twitter.com/vite_js" title="twitter" target="_blank" rel="noopener noreferrer" data-v-773e94b4 data-v-177a76b9><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-177a76b9><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg><span class="visually-hidden" data-v-177a76b9>twitter</span></a><a class="VPSocialLink" href="https://chat.vitejs.dev" title="discord" target="_blank" rel="noopener noreferrer" data-v-773e94b4 data-v-177a76b9><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-177a76b9><path d="M20.222 0c1.406 0 2.54 1.137 2.607 2.475V24l-2.677-2.273-1.47-1.338-1.604-1.398.67 2.205H3.71c-1.402 0-2.54-1.065-2.54-2.476V2.48C1.17 1.142 2.31.003 3.715.003h16.5L20.222 0zm-6.118 5.683h-.03l-.202.2c2.073.6 3.076 1.537 3.076 1.537-1.336-.668-2.54-1.002-3.744-1.137-.87-.135-1.74-.064-2.475 0h-.2c-.47 0-1.47.2-2.81.735-.467.203-.735.336-.735.336s1.002-1.002 3.21-1.537l-.135-.135s-1.672-.064-3.477 1.27c0 0-1.805 3.144-1.805 7.02 0 0 1 1.74 3.743 1.806 0 0 .4-.533.805-1.002-1.54-.468-2.14-1.404-2.14-1.404s.134.066.335.2h.06c.03 0 .044.015.06.03v.006c.016.016.03.03.06.03.33.136.66.27.93.4.466.202 1.065.403 1.8.536.93.135 1.996.2 3.21 0 .6-.135 1.2-.267 1.8-.535.39-.2.87-.4 1.397-.737 0 0-.6.936-2.205 1.404.33.466.795 1 .795 1 2.744-.06 3.81-1.8 3.87-1.726 0-3.87-1.815-7.02-1.815-7.02-1.635-1.214-3.165-1.26-3.435-1.26l.056-.02zm.168 4.413c.703 0 1.27.6 1.27 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334.002-.74.573-1.338 1.27-1.338zm-4.543 0c.7 0 1.266.6 1.266 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334 0-.74.57-1.338 1.27-1.338z"></path></svg><span class="visually-hidden" data-v-177a76b9>discord</span></a><a class="VPSocialLink" href="https://github.com/vitejs/vite" title="github" target="_blank" rel="noopener noreferrer" data-v-773e94b4 data-v-177a76b9><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-177a76b9><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg><span class="visually-hidden" data-v-177a76b9>github</span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-1266da0c data-v-8a0f8f1c><span class="container" data-v-8a0f8f1c><span class="top" data-v-8a0f8f1c></span><span class="middle" data-v-8a0f8f1c></span><span class="bottom" data-v-8a0f8f1c></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-668b17a8 data-v-1669fa5e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-1669fa5e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-1669fa5e><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-1669fa5e>Menu</span></button><a class="top-link" href="#" data-v-1669fa5e> Return to top </a></div><aside class="VPSidebar" data-v-668b17a8 data-v-74d03e9e><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-74d03e9e><span class="visually-hidden" id="sidebar-aria-label" data-v-74d03e9e> Sidebar Navigation </span><!--[--><div class="group" data-v-74d03e9e><section class="VPSidebarGroup" data-v-74d03e9e data-v-f828d5a0><div class="title" data-v-f828d5a0><h2 class="title-text" data-v-f828d5a0>Guide</h2><div class="action" data-v-f828d5a0><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-f828d5a0><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-f828d5a0><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-f828d5a0><!--[--><a class="VPLink link" href="/guide/why.html" data-v-f828d5a0 data-v-71035254 data-v-50be448c><!--[--><span class="link-text" data-v-71035254>Why Vite</span><!--]--><!----></a><a class="VPLink link" href="/guide/" data-v-f828d5a0 data-v-71035254 data-v-50be448c><!--[--><span class="link-text" data-v-71035254>Getting Started</span><!--]--><!----></a><a class="VPLink link" href="/guide/features.html" data-v-f828d5a0 data-v-71035254 data-v-50be448c><!--[--><span class="link-text" data-v-71035254>Features</span><!--]--><!----></a><a class="VPLink link" href="/guide/using-plugins.html" data-v-f828d5a0 data-v-71035254 data-v-50be448c><!--[--><span class="link-text" data-v-71035254>Using Plugins</span><!--]--><!----></a><a class="VPLink link" href="/guide/dep-pre-bundling.html" data-v-f828d5a0 data-v-71035254 data-v-50be448c><!--[--><span class="link-text" data-v-71035254>Dependency Pre-Bundling</span><!--]--><!----></a><a class="VPLink link" href="/guide/assets.html" data-v-f828d5a0 data-v-71035254 data-v-50be448c><!--[--><span class="link-text" data-v-71035254>Static Asset Handling</span><!--]--><!----></a><a class="VPLink link" href="/guide/build.html" data-v-f828d5a0 data-v-71035254 data-v-50be448c><!--[--><span class="link-text" data-v-71035254>Building for Production</span><!--]--><!----></a><a class="VPLink link" href="/guide/static-deploy.html" data-v-f828d5a0 data-v-71035254 data-v-50be448c><!--[--><span class="link-text" data-v-71035254>Deploying a Static Site</span><!--]--><!----></a><a class="VPLink link" href="/guide/env-and-mode.html" data-v-f828d5a0 data-v-71035254 data-v-50be448c><!--[--><span class="link-text" data-v-71035254>Env Variables and Modes</span><!--]--><!----></a><a class="VPLink link active" href="/guide/ssr.html" data-v-f828d5a0 data-v-71035254 data-v-50be448c><!--[--><span class="link-text" data-v-71035254>Server-Side Rendering (SSR)</span><!--]--><!----></a><a class="VPLink link" href="/guide/backend-integration.html" data-v-f828d5a0 data-v-71035254 data-v-50be448c><!--[--><span class="link-text" data-v-71035254>Backend Integration</span><!--]--><!----></a><a class="VPLink link" href="/guide/comparisons.html" data-v-f828d5a0 data-v-71035254 data-v-50be448c><!--[--><span class="link-text" data-v-71035254>Comparisons</span><!--]--><!----></a><a class="VPLink link" href="/guide/migration.html" data-v-f828d5a0 data-v-71035254 data-v-50be448c><!--[--><span class="link-text" data-v-71035254>Migration from v2</span><!--]--><!----></a><!--]--></div></section></div><div class="group" data-v-74d03e9e><section class="VPSidebarGroup" data-v-74d03e9e data-v-f828d5a0><div class="title" data-v-f828d5a0><h2 class="title-text" data-v-f828d5a0>APIs</h2><div class="action" data-v-f828d5a0><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-f828d5a0><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-f828d5a0><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-f828d5a0><!--[--><a class="VPLink link" href="/guide/api-plugin.html" data-v-f828d5a0 data-v-71035254 data-v-50be448c><!--[--><span class="link-text" data-v-71035254>Plugin API</span><!--]--><!----></a><a class="VPLink link" href="/guide/api-hmr.html" data-v-f828d5a0 data-v-71035254 data-v-50be448c><!--[--><span class="link-text" data-v-71035254>HMR API</span><!--]--><!----></a><a class="VPLink link" href="/guide/api-javascript.html" data-v-f828d5a0 data-v-71035254 data-v-50be448c><!--[--><span class="link-text" data-v-71035254>JavaScript API</span><!--]--><!----></a><a class="VPLink link" href="/config/" data-v-f828d5a0 data-v-71035254 data-v-50be448c><!--[--><span class="link-text" data-v-71035254>Config Reference</span><!--]--><!----></a><!--]--></div></section></div><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-668b17a8 data-v-60c297c0><div class="VPDoc has-sidebar" data-v-60c297c0 data-v-1682693d><div class="container" data-v-1682693d><div class="aside" data-v-1682693d><div class="aside-curtain" data-v-1682693d></div><div class="aside-container" data-v-1682693d><div class="aside-content" data-v-1682693d><div class="VPDocAside" data-v-1682693d data-v-2e6ddbaa><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline has-outline" data-v-2e6ddbaa data-v-35985eaa><div class="content" data-v-35985eaa><div class="outline-marker" data-v-35985eaa></div><div class="outline-title" data-v-35985eaa>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-35985eaa><span class="visually-hidden" id="doc-outline-aria-label" data-v-35985eaa> Table of Contents for current page </span><ul class="root" data-v-35985eaa><!--[--><li style="" data-v-35985eaa><a class="outline-link" href="#example-projects" data-v-35985eaa>Example Projects</a><!----></li><li style="" data-v-35985eaa><a class="outline-link" href="#source-structure" data-v-35985eaa>Source Structure</a><!----></li><li style="" data-v-35985eaa><a class="outline-link" href="#conditional-logic" data-v-35985eaa>Conditional Logic</a><!----></li><li style="" data-v-35985eaa><a class="outline-link" href="#setting-up-the-dev-server" data-v-35985eaa>Setting Up the Dev Server</a><!----></li><li style="" data-v-35985eaa><a class="outline-link" href="#building-for-production" data-v-35985eaa>Building for Production</a><!----></li><li style="" data-v-35985eaa><a class="outline-link" href="#generating-preload-directives" data-v-35985eaa>Generating Preload Directives</a><!----></li><li style="" data-v-35985eaa><a class="outline-link" href="#pre-rendering-ssg" data-v-35985eaa>Pre-Rendering / SSG</a><!----></li><li style="" data-v-35985eaa><a class="outline-link" href="#ssr-externals" data-v-35985eaa>SSR Externals</a><!----></li><li style="" data-v-35985eaa><a class="outline-link" href="#ssr-specific-plugin-logic" data-v-35985eaa>SSR-specific Plugin Logic</a><!----></li><li style="" data-v-35985eaa><a class="outline-link" href="#ssr-target" data-v-35985eaa>SSR Target</a><!----></li><li style="" data-v-35985eaa><a class="outline-link" href="#ssr-bundle" data-v-35985eaa>SSR Bundle</a><!----></li><li style="" data-v-35985eaa><a class="outline-link" href="#vite-cli" data-v-35985eaa>Vite CLI</a><!----></li><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-2e6ddbaa></div><!--[--><!--[--><!--[--><!--[--><!----><!--]--><!--]--><!--]--><!--]--><div class="VPDocAsideCarbonAds" data-v-2e6ddbaa><div class="VPCarbonAds"></div></div><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-1682693d><div class="content-container" data-v-1682693d><!--[--><!--]--><main class="main" data-v-1682693d><div style="position:relative;" class="vp-doc _guide_ssr" data-v-1682693d><div><h1 id="server-side-rendering" tabindex="-1">Server-Side Rendering <a class="header-anchor" href="#server-side-rendering" aria-hidden="true">#</a></h1><div class="warning custom-block"><p class="custom-block-title">Experimental</p><p>SSR support is still experimental and you may encounter bugs and unsupported use cases. Proceed at your own risk.</p></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>SSR specifically refers to front-end frameworks (for example React, Preact, Vue, and Svelte) that support running the same application in Node.js, pre-rendering it to HTML, and finally hydrating it on the client. If you are looking for integration with traditional server-side frameworks, check out the <a href="./backend-integration.html">Backend Integration guide</a> instead.</p><p>The following guide also assumes prior experience working with SSR in your framework of choice, and will only focus on Vite-specific integration details.</p></div><div class="warning custom-block"><p class="custom-block-title">Low-level API</p><p>This is a low-level API meant for library and framework authors. If your goal is to create an application, make sure to check out the higher-level SSR plugins and tools at <a href="https://github.com/vitejs/awesome-vite#ssr" target="_blank" rel="noopener noreferrer">Awesome Vite SSR section</a> first. That said, many applications are successfully built directly on top of Vite&#39;s native low-level API.</p></div><div class="tip custom-block"><p class="custom-block-title">Help</p><p>If you have questions, the community is usually helpful at <a href="https://discord.gg/PkbxgzPhJv" target="_blank" rel="noopener noreferrer">Vite Discord&#39;s #ssr channel</a>.</p></div><h2 id="example-projects" tabindex="-1">Example Projects <a class="header-anchor" href="#example-projects" aria-hidden="true">#</a></h2><p>Vite provides built-in support for server-side rendering (SSR). The Vite playground contains example SSR setups for Vue 3 and React, which can be used as references for this guide:</p><ul><li><a href="https://github.com/vitejs/vite/tree/main/playground/ssr-vue" target="_blank" rel="noopener noreferrer">Vue 3</a></li><li><a href="https://github.com/vitejs/vite/tree/main/playground/ssr-react" target="_blank" rel="noopener noreferrer">React</a></li></ul><h2 id="source-structure" tabindex="-1">Source Structure <a class="header-anchor" href="#source-structure" aria-hidden="true">#</a></h2><p>A typical SSR application will have the following source file structure:</p><div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">- index.html</span></span>
<span class="line"><span style="color:#A6ACCD;">- server.js # main application server</span></span>
<span class="line"><span style="color:#A6ACCD;">- src/</span></span>
<span class="line"><span style="color:#A6ACCD;">  - main.js          # exports env-agnostic (universal) app code</span></span>
<span class="line"><span style="color:#A6ACCD;">  - entry-client.js  # mounts the app to a DOM element</span></span>
<span class="line"><span style="color:#A6ACCD;">  - entry-server.js  # renders the app using the framework&#39;s SSR API</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>The <code>index.html</code> will need to reference <code>entry-client.js</code> and include a placeholder where the server-rendered markup should be injected:</p><div class="language-html"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">app</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#676E95;font-style:italic;">&lt;!--ssr-outlet--&gt;</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">module</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">src</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/src/entry-client.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>You can use any placeholder you prefer instead of <code>&lt;!--ssr-outlet--&gt;</code>, as long as it can be precisely replaced.</p><h2 id="conditional-logic" tabindex="-1">Conditional Logic <a class="header-anchor" href="#conditional-logic" aria-hidden="true">#</a></h2><p>If you need to perform conditional logic based on SSR vs. client, you can use</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">meta</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">env</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">SSR) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// ... server only logic</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>This is statically replaced during build so it will allow tree-shaking of unused branches.</p><h2 id="setting-up-the-dev-server" tabindex="-1">Setting Up the Dev Server <a class="header-anchor" href="#setting-up-the-dev-server" aria-hidden="true">#</a></h2><p>When building an SSR app, you likely want to have full control over your main server and decouple Vite from the production environment. It is therefore recommended to use Vite in middleware mode. Here is an example with <a href="https://expressjs.com/" target="_blank" rel="noopener noreferrer">express</a>:</p><p><strong>server.js</strong></p><div class="language-js"><span class="copy"></span><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br></div><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">path</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> express </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">createServer</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> createViteServer </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vite</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createServer</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">app</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">express</span><span style="color:#F07178;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// Create Vite server in middleware mode and configure the app type as</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// &#39;custom&#39;, disabling Vite&#39;s own HTML serving logic so parent server</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// can take control</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">vite</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">createViteServer</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    server</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> middlewareMode</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">    appType</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">custom</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// use vite&#39;s connect instance as middleware</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// if you use your own express router (express.Router()), you should use router.use</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">vite</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">middlewares</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">async</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// serve index.html - we will tackle this next</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listen</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">5173</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">createServer</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"></span></code></pre></div><p>Here <code>vite</code> is an instance of <a href="./api-javascript.html#vitedevserver">ViteDevServer</a>. <code>vite.middlewares</code> is a <a href="https://github.com/senchalabs/connect" target="_blank" rel="noopener noreferrer">Connect</a> instance which can be used as a middleware in any connect-compatible Node.js framework.</p><p>The next step is implementing the <code>*</code> handler to serve server-rendered HTML:</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> res</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> next</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">url</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">originalUrl</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 1. Read index.html</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">template</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFileSync</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">__dirname</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">index.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 2. Apply Vite HTML transforms. This injects the Vite HMR client, and</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//    also applies HTML transforms from Vite plugins, e.g. global preambles</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//    from @vitejs/plugin-react</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">template</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">vite</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">transformIndexHtml</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">template</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 3. Load the server entry. vite.ssrLoadModule automatically transforms</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//    your ESM source code to be usable in Node.js! There is no bundling</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//    required, and provides efficient invalidation similar to HMR.</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">render</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">vite</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ssrLoadModule</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/src/entry-server.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 4. render the app HTML. This assumes entry-server.js&#39;s exported `render`</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//    function calls appropriate framework SSR APIs,</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//    e.g. ReactDOMServer.renderToString()</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">appHtml</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">render</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">url</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 5. Inject the app-rendered HTML into the template.</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">html</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">template</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">replace</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">&lt;!--ssr-outlet--&gt;</span><span style="color:#89DDFF;">`</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">appHtml</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 6. Send the rendered HTML back.</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">status</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">200</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">Content-Type</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">text/html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">end</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">html</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">e</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// If an error is caught, let Vite fix the stack trace so it maps back to</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// your actual source code.</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">vite</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ssrFixStacktrace</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>The <code>dev</code> script in <code>package.json</code> should also be changed to use the server script instead:</p><div class="language-diff"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">  &quot;scripts&quot;: {</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;">   &quot;dev&quot;: &quot;vite&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;">   &quot;dev&quot;: &quot;node server&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  }</span></span>
<span class="line"></span></code></pre></div><h2 id="building-for-production" tabindex="-1">Building for Production <a class="header-anchor" href="#building-for-production" aria-hidden="true">#</a></h2><p>To ship an SSR project for production, we need to:</p><ol><li>Produce a client build as normal;</li><li>Produce an SSR build, which can be directly loaded via <code>require()</code> so that we don&#39;t have to go through Vite&#39;s <code>ssrLoadModule</code>;</li></ol><p>Our scripts in <code>package.json</code> will look like this:</p><div class="language-json"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">scripts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">dev</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">node server</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">build:client</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">vite build --outDir dist/client</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">build:server</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">vite build --outDir dist/server --ssr src/entry-server.js </span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>Note the <code>--ssr</code> flag which indicates this is an SSR build. It should also specify the SSR entry.</p><p>Then, in <code>server.js</code> we need to add some production specific logic by checking <code>process.<wbr>env.</code><wbr><code>NODE_ENV</code>:</p><ul><li><p>Instead of reading the root <code>index.html</code>, use the <code>dist/client/index.html</code> as the template instead, since it contains the correct asset links to the client build.</p></li><li><p>Instead of <code>await vite.ssrLoadModule(&#39;/src/entry-server.js&#39;)</code>, use <code>require(&#39;./dist/server/entry-server.js&#39;)</code> instead (this file is the result of the SSR build).</p></li><li><p>Move the creation and all usage of the <code>vite</code> dev server behind dev-only conditional branches, then add static file serving middlewares to serve files from <code>dist/client</code>.</p></li></ul><p>Refer to the <a href="https://github.com/vitejs/vite/tree/main/playground/ssr-vue" target="_blank" rel="noopener noreferrer">Vue</a> and <a href="https://github.com/vitejs/vite/tree/main/playground/ssr-react" target="_blank" rel="noopener noreferrer">React</a> demos for working setup.</p><h2 id="generating-preload-directives" tabindex="-1">Generating Preload Directives <a class="header-anchor" href="#generating-preload-directives" aria-hidden="true">#</a></h2><p><code>vite build</code> supports the <code>--ssrManifest</code> flag which will generate <code>ssr-manifest.json</code> in build output directory:</p><div class="language-diff"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> &quot;build:client&quot;: &quot;vite build --outDir dist/client&quot;,</span></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;"> &quot;build:client&quot;: &quot;vite build --outDir dist/client --ssrManifest&quot;,</span></span>
<span class="line"></span></code></pre></div><p>The above script will now generate <code>dist/client/ssr-manifest.json</code> for the client build (Yes, the SSR manifest is generated from the client build because we want to map module IDs to client files). The manifest contains mappings of module IDs to their associated chunks and asset files.</p><p>To leverage the manifest, frameworks need to provide a way to collect the module IDs of the components that were used during a server render call.</p><p><code>@vitejs/plugin-vue</code> supports this out of the box and automatically registers used component module IDs on to the associated Vue SSR context:</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// src/entry-server.js</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> ctx </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> html </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#A6ACCD;"> vueServerRenderer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">renderToString</span><span style="color:#A6ACCD;">(app</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> ctx)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// ctx.modules is now a Set of module IDs that were used during the render</span></span>
<span class="line"></span></code></pre></div><p>In the production branch of <code>server.js</code> we need to read and pass the manifest to the <code>render</code> function exported by <code>src/entry-server.js</code>. This would provide us with enough information to render preload directives for files used by async routes! See <a href="https://github.com/vitejs/vite/blob/main/playground/ssr-vue/src/entry-server.js" target="_blank" rel="noopener noreferrer">demo source</a> for full example.</p><h2 id="pre-rendering-ssg" tabindex="-1">Pre-Rendering / SSG <a class="header-anchor" href="#pre-rendering-ssg" aria-hidden="true">#</a></h2><p>If the routes and the data needed for certain routes are known ahead of time, we can pre-render these routes into static HTML using the same logic as production SSR. This can also be considered a form of Static-Site Generation (SSG). See <a href="https://github.com/vitejs/vite/blob/main/playground/ssr-vue/prerender.js" target="_blank" rel="noopener noreferrer">demo pre-render script</a> for working example.</p><h2 id="ssr-externals" tabindex="-1">SSR Externals <a class="header-anchor" href="#ssr-externals" aria-hidden="true">#</a></h2><p>Many dependencies ship both ESM and CommonJS files. When running SSR, a dependency that provides CommonJS builds can be &quot;externalized&quot; from Vite&#39;s SSR transform / module system to speed up both dev and build. For example, instead of pulling in the pre-bundled ESM version of React and then transforming it back to be Node.js-compatible, it is more efficient to simply <code>require(&#39;react&#39;)</code> instead. It also greatly improves the speed of the SSR bundle build.</p><p>Vite performs automated SSR externalization based on the following heuristics:</p><ul><li><p>If a dependency&#39;s resolved ESM entry point and its default Node entry point are different, its default Node entry is probably a CommonJS build that can be externalized. For example, <code>vue</code> will be automatically externalized because it ships both ESM and CommonJS builds.</p></li><li><p>Otherwise, Vite will check whether the package&#39;s entry point contains valid ESM syntax - if not, the package is likely CommonJS and will be externalized. As an example, <code>react-dom</code> will be automatically externalized because it only specifies a single entry which is in CommonJS format.</p></li></ul><p>If this heuristics leads to errors, you can manually adjust SSR externals using <code>ssr.external</code> and <code>ssr.noExternal</code> config options.</p><p>In the future, this heuristics will likely improve to detect if the project has <code>type: &quot;module&quot;</code> enabled, so that Vite can also externalize dependencies that ship Node-compatible ESM builds by importing them via dynamic <code>import()</code> during SSR.</p><div class="warning custom-block"><p class="custom-block-title">Working with Aliases</p><p>If you have configured aliases that redirects one package to another, you may want to alias the actual <code>node_modules</code> packages instead to make it work for SSR externalized dependencies. Both <a href="https://classic.yarnpkg.com/en/docs/cli/add/#toc-yarn-add-alias" target="_blank" rel="noopener noreferrer">Yarn</a> and <a href="https://pnpm.js.org/en/aliases" target="_blank" rel="noopener noreferrer">pnpm</a> support aliasing via the <code>npm:</code> prefix.</p></div><h2 id="ssr-specific-plugin-logic" tabindex="-1">SSR-specific Plugin Logic <a class="header-anchor" href="#ssr-specific-plugin-logic" aria-hidden="true">#</a></h2><p>Some frameworks such as Vue or Svelte compiles components into different formats based on client vs. SSR. To support conditional transforms, Vite passes an additional <code>ssr</code> property in the <code>options</code> object of the following plugin hooks:</p><ul><li><code>resolveId</code></li><li><code>load</code></li><li><code>transform</code></li></ul><p><strong>Example:</strong></p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">mySSRPlugin</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    name</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">my-ssr</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    transform</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">code</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">id</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">options</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">options</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">ssr</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// perform ssr-specific transform...</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>The options object in <code>load</code> and <code>transform</code> is optional, rollup is not currently using this object but may extend these hooks with additional metadata in the future.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Before Vite 2.7, this was informed to plugin hooks with a positional <code>ssr</code> param instead of using the <code>options</code> object. All major frameworks and plugins are updated but you may find outdated posts using the previous API.</p></div><h2 id="ssr-target" tabindex="-1">SSR Target <a class="header-anchor" href="#ssr-target" aria-hidden="true">#</a></h2><p>The default target for the SSR build is a node environment, but you can also run the server in a Web Worker. Packages entry resolution is different for each platform. You can configure the target to be Web Worker using the <code>ssr.target</code> set to <code>&#39;webworker&#39;</code>.</p><h2 id="ssr-bundle" tabindex="-1">SSR Bundle <a class="header-anchor" href="#ssr-bundle" aria-hidden="true">#</a></h2><p>In some cases like <code>webworker</code> runtimes, you might want to bundle your SSR build into a single JavaScript file. You can enable this behavior by setting <code>ssr.noExternal</code> to <code>true</code>. This will do two things:</p><ul><li>Treat all dependencies as <code>noExternal</code></li><li>Throw an error if any Node.js built-ins are imported</li></ul><h2 id="vite-cli" tabindex="-1">Vite CLI <a class="header-anchor" href="#vite-cli" aria-hidden="true">#</a></h2><p>The CLI commands <code>$ vite dev</code> and <code>$ vite preview</code> can also be used for SSR apps. You can add your SSR middlewares to the development server with <a href="/guide/api-plugin.html#configureserver"><code>configureServer</code></a> and to the preview server with <a href="/guide/api-plugin.html#configurepreviewserver"><code>configurePreviewServer</code></a>.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Use a post hook so that your SSR middleware runs <em>after</em> Vite&#39;s middlewares.</p></div></div></div></main><footer class="VPDocFooter" data-v-1682693d data-v-96f85bbe><div class="edit-info" data-v-96f85bbe><div class="edit-link" data-v-96f85bbe><a class="VPLink link edit-link-button" href="https://github.com/vitejs/vite/edit/main/docs/guide/ssr.md" target="_blank" rel="noopener noreferrer" data-v-96f85bbe data-v-50be448c><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="edit-link-icon" data-v-96f85bbe><path d="M18,23H4c-1.7,0-3-1.3-3-3V6c0-1.7,1.3-3,3-3h7c0.6,0,1,0.4,1,1s-0.4,1-1,1H4C3.4,5,3,5.4,3,6v14c0,0.6,0.4,1,1,1h14c0.6,0,1-0.4,1-1v-7c0-0.6,0.4-1,1-1s1,0.4,1,1v7C21,21.7,19.7,23,18,23z"></path><path d="M8,17c-0.3,0-0.5-0.1-0.7-0.3C7,16.5,6.9,16.1,7,15.8l1-4c0-0.2,0.1-0.3,0.3-0.5l9.5-9.5c1.2-1.2,3.2-1.2,4.4,0c1.2,1.2,1.2,3.2,0,4.4l-9.5,9.5c-0.1,0.1-0.3,0.2-0.5,0.3l-4,1C8.2,17,8.1,17,8,17zM9.9,12.5l-0.5,2.1l2.1-0.5l9.3-9.3c0.4-0.4,0.4-1.1,0-1.6c-0.4-0.4-1.2-0.4-1.6,0l0,0L9.9,12.5z M18.5,2.5L18.5,2.5L18.5,2.5z"></path></svg> Suggest changes to this page<!--]--><!----></a></div><!----></div><div class="prev-next" data-v-96f85bbe><div class="pager" data-v-96f85bbe><a class="pager-link prev" href="/guide/env-and-mode.html" data-v-96f85bbe><span class="desc" data-v-96f85bbe>Previous page</span><span class="title" data-v-96f85bbe>Env Variables and Modes</span></a></div><div class="has-prev pager" data-v-96f85bbe><a class="pager-link next" href="/guide/backend-integration.html" data-v-96f85bbe><span class="desc" data-v-96f85bbe>Next page</span><span class="title" data-v-96f85bbe>Backend Integration</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter has-sidebar" data-v-668b17a8 data-v-449917b6><div class="container" data-v-449917b6><p class="message" data-v-449917b6>Released under the MIT License.</p><p class="copyright" data-v-449917b6>Copyright © 2019-present Evan You &amp; Vite Contributors</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"blog_announcing-vite2.md\":\"99d52ef6\",\"config_build-options.md\":\"707df608\",\"config_dep-optimization-options.md\":\"e6b282e5\",\"config_index.md\":\"f64074a2\",\"config_preview-options.md\":\"0fd8c34d\",\"config_server-options.md\":\"bf1bc4ac\",\"config_shared-options.md\":\"87adafb3\",\"config_ssr-options.md\":\"a65ed667\",\"config_worker-options.md\":\"9c3029ee\",\"guide_api-hmr.md\":\"270b8e42\",\"guide_api-javascript.md\":\"3127c91a\",\"guide_api-plugin.md\":\"db714c10\",\"guide_assets.md\":\"0b8c1375\",\"guide_backend-integration.md\":\"5c908cd9\",\"guide_build.md\":\"7868ac1b\",\"guide_comparisons.md\":\"c3696137\",\"guide_dep-pre-bundling.md\":\"68fe08eb\",\"guide_env-and-mode.md\":\"d985b386\",\"guide_features.md\":\"f1e263c9\",\"guide_index.md\":\"db5d8ce7\",\"guide_migration.md\":\"001e54b2\",\"guide_ssr.md\":\"7b8f8c80\",\"guide_static-deploy.md\":\"54370ef1\",\"guide_using-plugins.md\":\"c471c3eb\",\"guide_why.md\":\"c12a69aa\",\"index.md\":\"6106115f\",\"plugins_index.md\":\"b21bd842\"}")</script>
    <script type="module" async src="/assets/app.1478ba28.js"></script>
    
  </body>
</html>